<div class="backgammon-container">

  <div class="play-online" *ngIf="showOnlineOption" (click)="playOnlineOrLocal()">
    {{onlineOrLocalText[currentViewState]}}
  </div>

  <div class="logout" *ngIf="localUser && currentViewState !== onlineViewStates.local" (click)="logOut()">
    Logout
  </div>

  <div class="menu" *ngIf="currentViewState===onlineViewStates.liveGame" (click)="goToMenu()">
    Menu
  </div>

  <div class="online-game-container" [ngClass]="currentViewState">
    <form [formGroup]="formGroup" (ngSubmit)="submit()">
      <div [ngClass]="{ 'sign-in':currentViewState===onlineViewStates.signIn,
                        'register':currentViewState===onlineViewStates.register,
                        'online-game':currentViewState===onlineViewStates.onlineGame,
                        'local-state':currentViewState===onlineViewStates.local,
                        'live-game':currentViewState===onlineViewStates.liveGame}">
        <div class="title">{{currentViewState===onlineViewStates.register ? 'Register': 'Sign In'}}</div>
        <div class="input-wrapper">
          <div class="label">Name:</div>
          <input type="text" formControlName="name">
        </div>
        <div class="form-error">{{formErrorMessages['name']}}</div>

        <div class="input-wrapper">
          <div class="label">Password:</div>
          <input type="text" formControlName="password">
        </div>
        <div class="form-error">{{formErrorMessages['password']}}</div>
        <div class="sign-in-register-toggle"
             (click)="toggleSignInRegister()">
          {{currentViewState===onlineViewStates.signIn ? 'Register': 'Sign In'}}
        </div>
      </div>
      <div class="sign-in-error">{{signInError}}</div>
      <button class="submit" type="submit" [disabled]="isDisabled()">{{submitButtonsText[currentViewState]}}
      </button>
    </form>

    <div class="online-game">
      <div class="title">Select Player</div>
      <select class="select-player" [(ngModel)]="selectedPlayer">
        <option *ngFor="let player of (onlinePlayers$ | async)" [ngValue]="player">
          <div> {{player.name}}</div>
        </option>
      </select>

      <div class="online-game-operations">
        <div class="invite"
             (click)="sendInvitation()"
             *ngIf="checkIfCanInvite(selectedPlayer)">
          Invite
        </div>
        <div class="continue"
             (click)="continue(selectedPlayer.name)"
             *ngIf="checkIfOpenGameExists(selectedPlayer)">Continue
        </div>
      </div>
    </div>

    <div class="online-game-details">
      <div class="invitations-container">

        <div *ngIf="localUser && localUser.invitations">
          <div class="received-invitations" *ngIf="localUser.invitations.received">
            <div class="list-title">Received Invitations:</div>
            <div *ngFor="let receivedInvitation of localUser.invitations?.received | keys">
              <div class="invitation">user: {{receivedInvitation}}
                <span (click)="acceptInvitation(receivedInvitation)">accept</span>
              </div>
            </div>
          </div>

          <div class="sent-invitations" *ngIf="localUser && localUser.invitations && localUser.invitations.sent">
            <div class="list-title">Sent Invitations:</div>
            <div *ngFor="let sentInvitation of localUser.invitations?.sent | keys">
              <div class="invitation">user: {{sentInvitation}}</div>
            </div>
          </div>
        </div>
      </div>

      <div class="opened-games" *ngIf="openedGames && openedGames.length">
        <span class="list-title">Opened Games:</span>
        <div *ngFor="let game of openedGames">
          <div class="opened-game-wrapper">
            <div class="game-name">{{game?.user.name}}</div>
            <div (click)="continue(game?.user.name)"
                 class="continue">Continue
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="canvas-wrapper" [hidden]="!showCanvas">
    <canvas #canvas width="684" height="575"></canvas>
  </div>
</div>
